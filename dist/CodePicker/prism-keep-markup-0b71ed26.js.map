{"version":3,"file":"prism-keep-markup-0b71ed26.js","sources":["../../node_modules/prismjs/plugins/keep-markup/prism-keep-markup.js"],"sourcesContent":["(function () {\n\n\tif (typeof self === 'undefined' || !self.Prism || !self.document || !document.createRange) {\n\t\treturn;\n\t}\n\n\tPrism.plugins.KeepMarkup = true;\n\n\tPrism.hooks.add('before-highlight', function (env) {\n\t\tif (!env.element.children.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Prism.util.isActive(env.element, 'keep-markup', true)) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar pos = 0;\n\t\tvar data = [];\n\t\tvar f = function (elt, baseNode) {\n\t\t\tvar o = {};\n\t\t\tif (!baseNode) {\n\t\t\t\t// Clone the original tag to keep all attributes\n\t\t\t\to.clone = elt.cloneNode(false);\n\t\t\t\to.posOpen = pos;\n\t\t\t\tdata.push(o);\n\t\t\t}\n\t\t\tfor (var i = 0, l = elt.childNodes.length; i < l; i++) {\n\t\t\t\tvar child = elt.childNodes[i];\n\t\t\t\tif (child.nodeType === 1) { // element\n\t\t\t\t\tf(child);\n\t\t\t\t} else if(child.nodeType === 3) { // text\n\t\t\t\t\tpos += child.data.length;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!baseNode) {\n\t\t\t\to.posClose = pos;\n\t\t\t}\n\t\t};\n\t\tf(env.element, true);\n\n\t\tif (data && data.length) {\n\t\t\t// data is an array of all existing tags\n\t\t\tenv.keepMarkup = data;\n\t\t}\n\t});\n\n\tPrism.hooks.add('after-highlight', function (env) {\n\t\tif(env.keepMarkup && env.keepMarkup.length) {\n\n\t\t\tvar walk = function (elt, nodeState) {\n\t\t\t\tfor (var i = 0, l = elt.childNodes.length; i < l; i++) {\n\n\t\t\t\t\tvar child = elt.childNodes[i];\n\n\t\t\t\t\tif (child.nodeType === 1) { // element\n\t\t\t\t\t\tif (!walk(child, nodeState)) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if (child.nodeType === 3) { // text\n\t\t\t\t\t\tif(!nodeState.nodeStart && nodeState.pos + child.data.length > nodeState.node.posOpen) {\n\t\t\t\t\t\t\t// We found the start position\n\t\t\t\t\t\t\tnodeState.nodeStart = child;\n\t\t\t\t\t\t\tnodeState.nodeStartPos = nodeState.node.posOpen - nodeState.pos;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(nodeState.nodeStart && nodeState.pos + child.data.length >= nodeState.node.posClose) {\n\t\t\t\t\t\t\t// We found the end position\n\t\t\t\t\t\t\tnodeState.nodeEnd = child;\n\t\t\t\t\t\t\tnodeState.nodeEndPos = nodeState.node.posClose - nodeState.pos;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tnodeState.pos += child.data.length;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (nodeState.nodeStart && nodeState.nodeEnd) {\n\t\t\t\t\t\t// Select the range and wrap it with the clone\n\t\t\t\t\t\tvar range = document.createRange();\n\t\t\t\t\t\trange.setStart(nodeState.nodeStart, nodeState.nodeStartPos);\n\t\t\t\t\t\trange.setEnd(nodeState.nodeEnd, nodeState.nodeEndPos);\n\t\t\t\t\t\tnodeState.node.clone.appendChild(range.extractContents());\n\t\t\t\t\t\trange.insertNode(nodeState.node.clone);\n\t\t\t\t\t\trange.detach();\n\n\t\t\t\t\t\t// Process is over\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t};\n\n\t\t\t// For each tag, we walk the DOM to reinsert it\n\t\t\tenv.keepMarkup.forEach(function (node) {\n\t\t\t\twalk(env.element, {\n\t\t\t\t\tnode: node,\n\t\t\t\t\tpos: 0\n\t\t\t\t});\n\t\t\t});\n\t\t\t// Store new highlightedCode for later hooks calls\n\t\t\tenv.highlightedCode = env.element.innerHTML;\n\t\t}\n\t});\n}());\n"],"names":[],"mappings":"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"}